---
- name: Install ncpa agent on instances
  host: all
  become: yes
  become_user: root
  tasks:
    - name: Create a repo on Centos6
      when: ansible_distribution == "CentOS" and ansible_distribution_major_version == "6"
      shell: "rpm -Uvh http://repo.nagios.com/nagios/6/nagios-repo-6-3.el6.noarch.rpm"
    
    - name: Install ncpa on centos 6
      when: ansible_distribution == "CentOS" and ansible_distribution_major_version == "6"
      package:
        name: ncpa
        state: present
    
    - name: Change the code inside ncpa.cfg
      lineinfile:
        path: 
        regex: ""
        line: 
    
    
    
    - name: Create a repo on Centos7
      when: ansible_distribution == "CentOS" and ansible_distribution_major_version == "7"
      shell: "rpm -Uvh http://repo.nagios.com/nagios/7/nagios-repo-7-3.el7.noarch.rpm"

    - name: Install ncpa on centos 6
      when: ansible_distribution == "CentOS" and ansible_distribution_major_version == "6"
      package:
        name: ncpa
        state: present