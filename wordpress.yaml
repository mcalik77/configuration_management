---
  - name: Installs wordpress
    hosts: localhost
    become: yes
    become_method: sudo
    gather_facts: no
    connection: ssh
    tasks:
      - name: copy repel repository
        shell: "wget -q http://rpms.remirepo.net/enterprise/remi-release-7.rpm"
        shell: "wget -q https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm"
        shell: "rpm -i remi-release-7.rpm epel-release-latest-7.noarch.rpm"
        shell: "yum-config-manager --enable remi-php70"
        become: yes
        become_method: sudo
        ignore_errors: yes
      
      - name: Install necessary packages
        package:
          name: "{{item}}"
          state: latest
        with_items:
          - wget 
          - php-gd
          - unzip 
          - httpd 
          - mysql 
          - mariadb-server 
          - php 
          - php-mysql 
          - php-fpm 
        ignore_errors: true

      
      - name: Download wordpress package
        get_url:
          url: "https://wordpress.org/latest.tar.gz"
          dest: /tmp/
              
      - name: Unzip wordpress file
        unarchive:
          src: "/tmp/wordpress-5.2.1.tar.gz"
          dest: /var/www/html/
          remote_src: yes
        become: yes
        become_method: sudo
      
      - name: move files to html folder
        shell: "mv /var/www/html/wordpress/* /var/www/html"
        become: yes
        become_method: sudo
        ignore_errors: yes
      
      - name: Restart httpd
        systemd:
          name: httpd
          state: restarted
          enabled: yes
        become: yes
        become_method: sudo
